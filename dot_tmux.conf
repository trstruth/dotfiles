##### Prefix & Basics #########################################################
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Quality of life
set -g mouse on                       # click to focus/resize/select
set -g history-limit 100000
set -g repeat-time 300                # faster multi-key repeats
set -g escape-time 10
setw -g allow-rename on
setw -g automatic-rename on
set -g base-index 1                   # windows start at 1
setw -g pane-base-index 1             # panes start at 1

# Color
set -g default-terminal "screen-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"

# Keep session-scoped environment in sync on attach (Wayland/Hyprland).
set -g update-environment "DISPLAY WAYLAND_DISPLAY XDG_SESSION_TYPE XDG_CURRENT_DESKTOP HYPRLAND_INSTANCE_SIGNATURE"

# Reload config
bind r source-file ~/.tmux.conf \; display 'tmux.conf reloaded'

##### Pane / Window Management ###############################################
# Splits (prefix + | or -)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# Navigate panes (Alt+Arrows) â€” works without prefix
bind -n M-Left  select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up    select-pane -U
bind -n M-Down  select-pane -D

# Navigate panes (Vim keys after prefix)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes (hold key to repeat)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# Fast pane swap (reorder)
bind '{' swap-pane -U
bind '}' swap-pane -D

# Toggle zoom (you already use this)
bind z resize-pane -Z

# Toggle synchronize panes (broadcast input to all panes)
bind S setw synchronize-panes \; display "synchronize-panes: #{?pane_synchronized,on,off}"

bind s choose-tree -s

# Cycle layouts
bind space next-layout

# Quick new window in current dir
bind c new-window -c "#{pane_current_path}"

##### Copy Mode & Clipboard ###################################################
# Use terminal OSC 52 clipboard when available (tmux 3.2+)
set -g set-clipboard on
setw -g mode-keys vi
# Selection in copy-mode-vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi V send -X select-line
bind -T copy-mode-vi y send -X copy-selection-and-cancel

# Paste (from tmux buffer)
bind p paste-buffer

##### Status Line (clean & informative) ######################################
set -g status on
set -g status-interval 2
set -g status-justify centre
set -g status-bg colour236
set -g status-fg colour250

set -g status-left-length 40
set -g status-right-length 120
set -g status-left  "#[bold] #S #[fg=colour240]| #[fg=colour250]#I:#P #[default]"
set -g status-right "#[fg=colour244]%Y-%m-%d %H:%M #[fg=colour240]| #[fg=colour250]#H "

# Active/inactive window styles
setw -g window-status-format       " #I:#W "
setw -g window-status-current-format "#[bold,underscore] #I:#W "
setw -g window-status-current-style "fg=white,bg=colour240"
setw -g window-status-style          "fg=colour250,bg=colour236"

# Pane border styles
set -g pane-border-style fg=colour238
set -g pane-active-border-style fg=colour110

##### Search / Copy-mode niceties ############################################
# Vi-style search with /
bind / command-prompt -p "search down"  "send -X search-forward '%%'"
bind ? command-prompt -p "search up"    "send -X search-backward '%%'"

##### Fast Session/Window Switching ##########################################
# Prefix + Tab: last window
bind Tab last-window

# Prefix + f: fuzzy-ish find window by name (tmux built-in prompt)
bind f command-prompt -p "find window:" "switch-client -t '%%'"

##### Optional: Mouse toggle if you sometimes hate the mouse ##################
bind m set -g mouse \; display "mouse: #{?mouse,on,off}"

##### Optional: TPM (Tmux Plugin Manager) & common plugins ###################
# Install TPM:
#   git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# Press: <prefix> I   to install plugins,  <prefix> U   to update
# set -g @plugin 'tmux-plugins/tpm'
# set -g @plugin 'tmux-plugins/tmux-sensible'   # sane defaults
# set -g @plugin 'tmux-plugins/tmux-yank'       # robust clipboard
# set -g @plugin 'tmux-plugins/tmux-resurrect'  # save/restore sessions
# set -g @plugin 'tmux-plugins/tmux-continuum'  # auto-resurrect

# Continuum tweaks (auto-save every 15 min)
set -g @continuum-restore 'on'
set -g @resurrect-save-interval '15'

# run '~/.tmux/plugins/tpm/tpm'
